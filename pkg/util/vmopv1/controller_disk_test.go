// Â© Broadcom. All Rights Reserved.
// The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
// SPDX-License-Identifier: Apache-2.0

package vmopv1_test

import (
	. "github.com/onsi/ginkgo/v2"
	. "github.com/onsi/gomega"

	vmopv1 "github.com/vmware-tanzu/vm-operator/api/v1alpha5"
	vmopv1util "github.com/vmware-tanzu/vm-operator/pkg/util/vmopv1"
)

var _ = Describe("IsControllerDiskSupported", func() {

	DescribeTable("supported combinations",
		func(opts []vmopv1util.IsControllerDiskSupportedOption) {
			err := vmopv1util.IsControllerDiskSupported(opts...)
			Expect(err).ToNot(HaveOccurred())
		},

		// ========================================================================
		// Comprehensive test coverage for all 123 supported combinations
		// Generated from empirical permutation test results
		// ========================================================================

		// BusLogic - supported combinations
		Entry("scsi-buslogic-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-independent_persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-virtual-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-physical-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-buslogic-virtual-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		// LSI Logic - supported combinations
		Entry("scsi-lsilogic-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-virtual-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-virtual-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-physical-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-physical-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-virtual-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		// LSI Logic SAS - supported combinations
		Entry("scsi-lsilogic-sas-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-sas-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-sas-virtual-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-sas-virtual-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-lsilogic-sas-physical-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-lsilogic-sas-physical-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogicSAS),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// PVSCSI - supported combinations
		Entry("scsi-pvscsi-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_nonpersistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_nonpersistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-virtual-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-virtual-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-physical-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-physical-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-virtual-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("scsi-pvscsi-virtual-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("scsi-pvscsi-physical-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// IDE - supported combinations
		Entry("ide-ide-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-independent_nonpersistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("ide-ide-none-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("ide-ide-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// SATA - supported combinations
		Entry("sata-ahci-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-independent_persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_nonpersistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_nonpersistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-independent_nonpersistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("sata-ahci-none-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("sata-ahci-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// NVME - supported combinations
		Entry("nvme-nvme-none-persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-independent_persistent-none-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-independent_nonpersistent-none-lazy-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-independent_nonpersistent-none-lazy-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-independent_nonpersistent-none-eager-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-independent_nonpersistent-none-eager-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThick),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
		Entry("nvme-nvme-none-persistent-multi-writer-eagerzero-otherlinux64",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("nvme-nvme-none-persistent-multi-writer-eagerzero-otherguest",
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),
	)

	DescribeTable("unsupported combinations",
		func(expectedError error, opts []vmopv1util.IsControllerDiskSupportedOption) {
			err := vmopv1util.IsControllerDiskSupported(opts...)
			Expect(err).To(HaveOccurred())
			Expect(err).To(Equal(expectedError))
		},

		// BusLogic SCSI with otherlinux64guest - not supported for 64-bit guests
		Entry("BusLogic SCSI not supported for 64-bit guests",
			vmopv1util.ErrBusLogicNot64BitGuest,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("BusLogic SCSI with virtual sharing and multi-writer not supported for 64-bit guests",
			vmopv1util.ErrBusLogicNot64BitGuest,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// Legacy disk modes - BusLogic
		Entry("BusLogic with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// Virtual/Physical sharing with non-multi-writer requires thick provisioning - BusLogic
		Entry("BusLogic with virtual sharing and persistent non-multi-writer requires thick provisioning",
			vmopv1util.ErrMultiWriterRequiresThick,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("BusLogic with physical sharing and independent persistent non-multi-writer requires thick provisioning",
			vmopv1util.ErrMultiWriterRequiresThick,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// LSI Logic - legacy disk modes
		Entry("LSI Logic with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// LSI Logic - sharing with non-multi-writer requires thick provisioning
		Entry("LSI Logic with virtual sharing and persistent non-multi-writer requires thick provisioning",
			vmopv1util.ErrMultiWriterRequiresThick,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeLsiLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// PVSCSI - legacy disk modes
		Entry("PVSCSI with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// PVSCSI - sharing with non-multi-writer requires thick provisioning
		Entry("PVSCSI with virtual sharing and persistent non-multi-writer requires thick provisioning",
			vmopv1util.ErrMultiWriterRequiresThick,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeVirtual),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
		Entry("PVSCSI with physical sharing and independent nonpersistent non-multi-writer requires thick provisioning",
			vmopv1util.ErrMultiWriterRequiresThick,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModePhysical),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// PVSCSI - multi-writer with independent_nonpersistent requires thick provisioning
		Entry("PVSCSI with independent nonpersistent multi-writer requires thick provisioning",
			vmopv1util.ErrIncompatibleBackingSharingVMFS,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// IDE - legacy disk modes
		Entry("IDE with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// IDE - multi-writer with independent_nonpersistent requires thick provisioning
		Entry("IDE with independent nonpersistent multi-writer requires thick provisioning",
			vmopv1util.ErrIncompatibleBackingSharingVMFS,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// SATA - legacy disk modes
		Entry("SATA with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// SATA - multi-writer with independent_nonpersistent requires thick provisioning
		Entry("SATA with independent nonpersistent multi-writer requires thick provisioning",
			vmopv1util.ErrIncompatibleBackingSharingVMFS,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSATA),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			},
		),

		// NVME - legacy disk modes
		Entry("NVME with nonpersistent disk mode not supported",
			vmopv1util.ErrLegacyDiskModes,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),

		// NVME - multi-writer with independent_nonpersistent requires thick provisioning
		Entry("NVME with independent nonpersistent multi-writer requires thick provisioning",
			vmopv1util.ErrIncompatibleBackingSharingVMFS,
			[]vmopv1util.IsControllerDiskSupportedOption{
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeNVME),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinux64guest"),
			},
		),
	)

	Context("guest ID normalization", func() {
		It("normalizes guest ID to lowercase", func() {
			// Test with uppercase variant
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("OTHERLINUX64GUEST"),
			)
			Expect(err).ToNot(HaveOccurred())
		})

		It("defaults unknown guest IDs to otherlinux64guest", func() {
			// Test with unsupported configuration for otherlinux64guest
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeBusLogic),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeIndependentNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("unknownGuestID"),
			)
			// Should fail because unknown guest ID defaults to otherlinux64guest
			// and BusLogic is not supported for 64-bit guests
			Expect(err).To(HaveOccurred())
			Expect(err.Error()).To(ContainSubstring("BusLogic SCSI adapter is not supported for 64-bit guests"))
		})
	})

	Context("controller type conversion", func() {
		It("handles all SCSI controller types", func() {
			scsiTypes := []vmopv1.SCSIControllerType{
				vmopv1.SCSIControllerTypeParaVirtualSCSI,
				vmopv1.SCSIControllerTypeLsiLogic,
				vmopv1.SCSIControllerTypeLsiLogicSAS,
				vmopv1.SCSIControllerTypeBusLogic,
			}

			for _, scsiType := range scsiTypes {
				err := vmopv1util.IsControllerDiskSupported(
					vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
					vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
					vmopv1util.WithScsiControllerType(scsiType),
					vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
					vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
					vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
					vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
					vmopv1util.WithGuestID("otherlinuxguest"),
				)
				// All should succeed with this combination except BusLogic (which doesn't fail for otherlinuxguest with persistent)
				if scsiType == vmopv1.SCSIControllerTypeBusLogic {
					// BusLogic should succeed with otherlinuxguest and persistent mode
					Expect(err).ToNot(HaveOccurred(), "Failed for SCSI type: %s", scsiType)
				} else {
					Expect(err).ToNot(HaveOccurred(), "Failed for SCSI type: %s", scsiType)
				}
			}
		})

		It("handles all controller types", func() {
			controllerTypes := []vmopv1.VirtualControllerType{
				vmopv1.VirtualControllerTypeSCSI,
				vmopv1.VirtualControllerTypeIDE,
				vmopv1.VirtualControllerTypeSATA,
				vmopv1.VirtualControllerTypeNVME,
			}

			for _, ctrlType := range controllerTypes {
				scsiType := vmopv1.SCSIControllerType("")
				if ctrlType == vmopv1.VirtualControllerTypeSCSI {
					scsiType = vmopv1.SCSIControllerTypeParaVirtualSCSI
				}

				err := vmopv1util.IsControllerDiskSupported(
					vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
					vmopv1util.WithControllerType(ctrlType),
					vmopv1util.WithScsiControllerType(scsiType),
					vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
					vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
					vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
					vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
					vmopv1util.WithGuestID("otherlinuxguest"),
				)
				// All should succeed with this combination
				Expect(err).ToNot(HaveOccurred(), "Failed for controller type: %s", ctrlType)
			}
		})
	})

	Context("controller sharing modes", func() {
		It("handles all sharing modes for SCSI controllers", func() {
			sharingModes := []vmopv1.VirtualControllerSharingMode{
				vmopv1.VirtualControllerSharingModeNone,
				vmopv1.VirtualControllerSharingModeVirtual,
				vmopv1.VirtualControllerSharingModePhysical,
			}

			for _, sharingMode := range sharingModes {
				err := vmopv1util.IsControllerDiskSupported(
					vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
					vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
					vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
					vmopv1util.WithControllerSharing(sharingMode),
					vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
					vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeMultiWriter),
					vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThickEagerZero),
					vmopv1util.WithGuestID("otherlinuxguest"),
				)
				// All should succeed with multi-writer
				Expect(err).ToNot(HaveOccurred(), "Failed for sharing mode: %s", sharingMode)
			}
		})
	})

	Context("disk modes", func() {
		It("handles all supported disk modes", func() {
			diskModes := []vmopv1.VolumeDiskMode{
				vmopv1.VolumeDiskModePersistent,
				vmopv1.VolumeDiskModeIndependentPersistent,
				vmopv1.VolumeDiskModeIndependentNonPersistent,
			}

			for _, diskMode := range diskModes {
				err := vmopv1util.IsControllerDiskSupported(
					vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
					vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
					vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
					vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
					vmopv1util.WithDiskMode(diskMode),
					vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
					vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
					vmopv1util.WithGuestID("otherlinuxguest"),
				)
				// All should succeed with IDE and none sharing
				Expect(err).ToNot(HaveOccurred(), "Failed for disk mode: %s", diskMode)
			}
		})

		It("handles legacy disk mode as unsupported", func() {
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeIDE),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModeNonPersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			Expect(err).To(HaveOccurred())
			Expect(err).To(Equal(vmopv1util.ErrLegacyDiskModes))
		})
	})

	Context("volume sharing modes", func() {
		It("handles both volume sharing modes", func() {
			sharingModes := []vmopv1.VolumeSharingMode{
				vmopv1.VolumeSharingModeNone,
				vmopv1.VolumeSharingModeMultiWriter,
			}

			for _, sharingMode := range sharingModes {
				provisioningType := vmopv1util.DiskProvisioningTypeThin
				if sharingMode == vmopv1.VolumeSharingModeMultiWriter {
					provisioningType = vmopv1util.DiskProvisioningTypeThickEagerZero
				}
				err := vmopv1util.IsControllerDiskSupported(
					vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
					vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
					vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
					vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
					vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
					vmopv1util.WithDiskSharing(sharingMode),
					vmopv1util.WithDiskProvisioningType(provisioningType),
					vmopv1util.WithGuestID("otherlinuxguest"),
				)
				Expect(err).ToNot(HaveOccurred(), "Failed for volume sharing mode: %s", sharingMode)
			}
		})
	})

	Context("default case coverage", func() {
		It("handles unknown controller type", func() {
			// Using an empty/unknown controller type should default to "unknown"
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerType("UnknownController")),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			// Should succeed since it's not in unsupported list
			Expect(err).ToNot(HaveOccurred())
		})

		It("handles unknown SCSI controller type", func() {
			// Using an empty/unknown SCSI type should default to pvscsi
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerType("UnknownSCSI")),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			// Should succeed since it defaults to pvscsi
			Expect(err).ToNot(HaveOccurred())
		})

		It("handles unknown controller sharing mode", func() {
			// Using an unknown sharing mode should default to "none"
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingMode("UnknownSharing")),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			// Should succeed since it defaults to none
			Expect(err).ToNot(HaveOccurred())
		})

		It("handles unknown disk mode", func() {
			// Using an unknown disk mode should default to "persistent"
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskMode("UnknownDiskMode")),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingModeNone),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			// Should succeed since it defaults to persistent
			Expect(err).ToNot(HaveOccurred())
		})

		It("handles unknown volume sharing mode", func() {
			// Using an unknown volume sharing mode should default to "none"
			err := vmopv1util.IsControllerDiskSupported(
				vmopv1util.WithDatastoreType(vmopv1util.DatastoreTypeVMFS),
				vmopv1util.WithControllerType(vmopv1.VirtualControllerTypeSCSI),
				vmopv1util.WithScsiControllerType(vmopv1.SCSIControllerTypeParaVirtualSCSI),
				vmopv1util.WithControllerSharing(vmopv1.VirtualControllerSharingModeNone),
				vmopv1util.WithDiskMode(vmopv1.VolumeDiskModePersistent),
				vmopv1util.WithDiskSharing(vmopv1.VolumeSharingMode("UnknownVolumeSharing")),
				vmopv1util.WithDiskProvisioningType(vmopv1util.DiskProvisioningTypeThin),
				vmopv1util.WithGuestID("otherlinuxguest"),
			)
			// Should succeed since it defaults to none
			Expect(err).ToNot(HaveOccurred())
		})
	})
})
