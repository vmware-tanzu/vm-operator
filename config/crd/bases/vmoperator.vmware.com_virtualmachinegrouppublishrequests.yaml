---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.1
  name: virtualmachinegrouppublishrequests.vmoperator.vmware.com
spec:
  group: vmoperator.vmware.com
  names:
    kind: VirtualMachineGroupPublishRequest
    listKind: VirtualMachineGroupPublishRequestList
    plural: virtualmachinegrouppublishrequests
    shortNames:
    - vmgrouppub
    singular: virtualmachinegrouppublishrequest
  scope: Namespaced
  versions:
  - name: v1alpha4
    schema:
      openAPIV3Schema:
        description: |-
          VirtualMachineGroupPublishRequest defines the information necessary to publish a
          VirtualMachineGroup as a VirtualMachineImage to an image registry.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: |-
              VirtualMachineGroupPublishRequestSpec defines the desired state of a
              VirtualMachineGroupPublishRequest.

              All the fields in this spec are optional. This is especially useful when a
              DevOps persona wants to publish a VM Group without doing anything more than
              applying a VirtualMachineGroupPublishRequest resource that has the same name
              as said VMs in the same namespace as said VMs in VM Group.
            properties:
              source:
                description: |-
                  Source is the source of the publication request,
                  ex. a VirtualMachineGroup resource.

                  If this value is omitted then the publication controller checks to
                  see if there is a resource with the same name as this
                  VirtualMachineGroupPublishRequest resource, an API version equal to
                  spec.source.apiVersion, and a kind equal to spec.source.kind. If such
                  a resource exists, then it is the source of the publication.
                properties:
                  apiVersion:
                    default: vmoperator.vmware.com/v1alpha1
                    description: APIVersion is the API version of the referenced object.
                    type: string
                  kind:
                    default: VirtualMachineGroup
                    description: Kind is the kind of referenced object.
                    type: string
                  name:
                    description: |-
                      Name is the name of the referenced object.

                      If omitted this value defaults to the name of the
                      VirtualMachineGroupPublishRequest resource.
                    type: string
                type: object
              target:
                description: |-
                  Target is the target of the publication request, ex. items
                  description and the location of ContentLibrary resource.

                  The controller uses spec.source.name + "-image" as the name of
                  the published item.

                  When this value is omitted, controller attempts to identify the
                  target location by matching a resource with an API version equal to
                  spec.target.location.apiVersion, a kind equal to spec.target.location.kind,
                  w/ the label "imageregistry.vmware.com/default".

                  Please note that while optional, if a VirtualMachineGroupPublishRequest sans
                  target information is applied to a namespace without a default
                  publication target, then the VirtualMachineGroupPublishRequest resource
                  will be marked in error.
                properties:
                  description:
                    description: |-
                      Description is the description assigned to all published targets that is
                      included in the VM Group.
                      If omitted, a default description will be assigned. "This image is
                      published through a virtual machine group publish request."
                    type: string
                  location:
                    description: |-
                      Location contains information about the location to which to publish
                      all the virtual machines in the virtual machine group.
                    properties:
                      apiVersion:
                        default: imageregistry.vmware.com/v1alpha1
                        description: APIVersion is the API version of the referenced
                          object.
                        type: string
                      kind:
                        default: ContentLibrary
                        description: Kind is the kind of referenced object.
                        type: string
                      name:
                        description: |-
                          Name is the name of the referenced object.

                          Please note an error will be returned if this field is not
                          set in a namespace that lacks a default publication target.

                          A default publication target is a resource with an API version
                          equal to spec.target.location.apiVersion, a kind equal to
                          spec.target.location.kind, and has the label
                          "imageregistry.vmware.com/default".
                        type: string
                    type: object
                type: object
              ttlSecondsAfterFinished:
                description: |-
                  TTLSecondsAfterFinished is the time-to-live duration for how long this
                  resource will be allowed to exist once the publication operation
                  completes. After the TTL expires, the resource will be automatically
                  deleted without the user having to take any direct action.
                  This will be passed into each VirtualMachinePublishRequestSpec.

                  If this field is unset then the request resource will not be
                  automatically deleted. If this field is set to zero then the request
                  resource is eligible for deletion immediately after it finishes.
                format: int64
                minimum: 0
                type: integer
            type: object
          status:
            description: |-
              VirtualMachineGroupPublishRequestStatus defines the observed state of a
              VirtualMachineGroupPublishRequest.
            properties:
              completionTime:
                description: |-
                  CompletionTime represents time when the request was completed. It is not
                  guaranteed to be set in happens-before order across separate operations.
                  It is represented in RFC3339 form and is in UTC.

                  The value of this field should be equal to the value of the
                  LastTransitionTime for the status condition Type=Complete.
                format: date-time
                type: string
              conditions:
                description: |-
                  Conditions is a list of the latest, available observations of the
                  request's current state.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              imageName:
                description: |-
                  ImageNames is a list of names of the VirtualMachineImage resources that
                  are eventually realized in the same namespace as the VM Group and publication
                  request after the publication operation completes.

                  This field will not be set until the VirtualMachineImage resources are
                  realized.
                items:
                  type: string
                type: array
              ready:
                description: |-
                  Ready is set to true only when all VMs in VM group have been published
                  successfully and the new VirtualMachineImage resources are ready.

                  Readiness is determined by waiting until there is status condition
                  Type=Complete and ensuring it and all other status conditions present
                  have a Status=True. The conditions present will be:

                    * MembersOwnerRefReady
                    * Complete
                type: boolean
              sourceRef:
                description: |-
                  SourceRef is the reference to the source of the publication request,
                  ex. a VirtualMachineGroup resource.
                properties:
                  apiVersion:
                    default: vmoperator.vmware.com/v1alpha1
                    description: APIVersion is the API version of the referenced object.
                    type: string
                  kind:
                    default: VirtualMachineGroup
                    description: Kind is the kind of referenced object.
                    type: string
                  name:
                    description: |-
                      Name is the name of the referenced object.

                      If omitted this value defaults to the name of the
                      VirtualMachineGroupPublishRequest resource.
                    type: string
                type: object
              startTime:
                description: |-
                  StartTime represents time when the request was acknowledged by the
                  controller. It is not guaranteed to be set in happens-before order
                  across separate operations. It is represented in RFC3339 form and is
                  in UTC.
                format: date-time
                type: string
              targetRef:
                description: |-
                  TargetRef is the reference to the target of the publication request,
                  ex. item information and a ContentLibrary resource.
                properties:
                  description:
                    description: |-
                      Description is the description assigned to all published targets that is
                      included in the VM Group.
                      If omitted, a default description will be assigned. "This image is
                      published through a virtual machine group publish request."
                    type: string
                  location:
                    description: |-
                      Location contains information about the location to which to publish
                      all the virtual machines in the virtual machine group.
                    properties:
                      apiVersion:
                        default: imageregistry.vmware.com/v1alpha1
                        description: APIVersion is the API version of the referenced
                          object.
                        type: string
                      kind:
                        default: ContentLibrary
                        description: Kind is the kind of referenced object.
                        type: string
                      name:
                        description: |-
                          Name is the name of the referenced object.

                          Please note an error will be returned if this field is not
                          set in a namespace that lacks a default publication target.

                          A default publication target is a resource with an API version
                          equal to spec.target.location.apiVersion, a kind equal to
                          spec.target.location.kind, and has the label
                          "imageregistry.vmware.com/default".
                        type: string
                    type: object
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
